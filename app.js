var jsonData = `[
{
    "id": "38172",
    "employee_name": "test23",
    "employee_salary": "20",
    "employee_age": "10",
    "profile_image": ""
},
{
    "id": "38173",
    "employee_name": "bhat54434",
    "employee_salary": "123",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38174",
    "employee_name": "ss1234",
    "employee_salary": "333",
    "employee_age": "33",
    "profile_image": ""
},
{
    "id": "38185",
    "employee_name": "test123",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38188",
    "employee_name": "testresult",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38193",
    "employee_name": "ssss",
    "employee_salary": "2123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38196",
    "employee_name": "testhansraajwww",
    "employee_salary": "0",
    "employee_age": "0",
    "profile_image": ""
},
{
    "id": "38200",
    "employee_name": "test12345",
    "employee_salary": "123",
    "employee_age": "24",
    "profile_image": ""
},
{
    "id": "38201",
    "employee_name": "",
    "employee_salary": "0",
    "employee_age": "0",
    "profile_image": ""
},
{
    "id": "38202",
    "employee_name": "btf1244g",
    "employee_salary": "11223",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38203",
    "employee_name": "user2",
    "employee_salary": "254",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38204",
    "employee_name": "user3",
    "employee_salary": "254",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38205",
    "employee_name": "bhat5444",
    "employee_salary": "123",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38206",
    "employee_name": "Amlslyeggst",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38207",
    "employee_name": "user4",
    "employee_salary": "254",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38208",
    "employee_name": "tJJKKJJest",
    "employee_salary": "1212321323",
    "employee_age": "45",
    "profile_image": ""
},
{
    "id": "38209",
    "employee_name": "testvishal",
    "employee_salary": "9634",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38210",
    "employee_name": "AAAAAAA",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38211",
    "employee_name": "Ram11",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38212",
    "employee_name": "bhat54",
    "employee_salary": "123",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38214",
    "employee_name": "Ram20",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38215",
    "employee_name": "bhat44",
    "employee_salary": "123",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38216",
    "employee_name": "test4",
    "employee_salary": "1234",
    "employee_age": "123",
    "profile_image": ""
},
{
    "id": "38218",
    "employee_name": "test5",
    "employee_salary": "1234",
    "employee_age": "123",
    "profile_image": ""
},
{
    "id": "38219",
    "employee_name": "BBBBB",
    "employee_salary": "1230",
    "employee_age": "23",
    "profile_image": ""
},
    {
    "id": "38172",
    "employee_name": "test23",
    "employee_salary": "20",
    "employee_age": "10",
    "profile_image": ""
},
{
    "id": "38173",
    "employee_name": "bhat54434",
    "employee_salary": "123",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38174",
    "employee_name": "ss1234",
    "employee_salary": "333",
    "employee_age": "33",
    "profile_image": ""
},
{
    "id": "38185",
    "employee_name": "test123",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38188",
    "employee_name": "testresult",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38193",
    "employee_name": "ssss",
    "employee_salary": "2123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38196",
    "employee_name": "testhansraajwww",
    "employee_salary": "0",
    "employee_age": "0",
    "profile_image": ""
},
{
    "id": "38200",
    "employee_name": "test12345",
    "employee_salary": "123",
    "employee_age": "24",
    "profile_image": ""
},
{
    "id": "38201",
    "employee_name": "",
    "employee_salary": "0",
    "employee_age": "0",
    "profile_image": ""
},
{
    "id": "38202",
    "employee_name": "btf1244g",
    "employee_salary": "11223",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38203",
    "employee_name": "user2",
    "employee_salary": "254",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38204",
    "employee_name": "user3",
    "employee_salary": "254",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38205",
    "employee_name": "bhat5444",
    "employee_salary": "123",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38206",
    "employee_name": "Amlslyeggst",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38207",
    "employee_name": "user4",
    "employee_salary": "254",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38208",
    "employee_name": "tJJKKJJest",
    "employee_salary": "1212321323",
    "employee_age": "45",
    "profile_image": ""
},
{
    "id": "38209",
    "employee_name": "testvishal",
    "employee_salary": "9634",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38210",
    "employee_name": "AAAAAAA",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38211",
    "employee_name": "Ram11",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38212",
    "employee_name": "bhat54",
    "employee_salary": "123",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38214",
    "employee_name": "Ram20",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38215",
    "employee_name": "bhat44",
    "employee_salary": "123",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38216",
    "employee_name": "test4",
    "employee_salary": "1234",
    "employee_age": "123",
    "profile_image": ""
},
{
    "id": "38218",
    "employee_name": "test5",
    "employee_salary": "1234",
    "employee_age": "123",
    "profile_image": ""
},
{
    "id": "38219",
    "employee_name": "BBBBB",
    "employee_salary": "1230",
    "employee_age": "23",
    "profile_image": ""
},
    {
    "id": "38172",
    "employee_name": "test23",
    "employee_salary": "20",
    "employee_age": "10",
    "profile_image": ""
},
{
    "id": "38173",
    "employee_name": "bhat54434",
    "employee_salary": "123",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38174",
    "employee_name": "ss1234",
    "employee_salary": "333",
    "employee_age": "33",
    "profile_image": ""
},
{
    "id": "38185",
    "employee_name": "test123",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38188",
    "employee_name": "testresult",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38193",
    "employee_name": "ssss",
    "employee_salary": "2123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38196",
    "employee_name": "testhansraajwww",
    "employee_salary": "0",
    "employee_age": "0",
    "profile_image": ""
},
{
    "id": "38200",
    "employee_name": "test12345",
    "employee_salary": "123",
    "employee_age": "24",
    "profile_image": ""
},
{
    "id": "38201",
    "employee_name": "",
    "employee_salary": "0",
    "employee_age": "0",
    "profile_image": ""
},
{
    "id": "38202",
    "employee_name": "btf1244g",
    "employee_salary": "11223",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38203",
    "employee_name": "user2",
    "employee_salary": "254",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38204",
    "employee_name": "user3",
    "employee_salary": "254",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38205",
    "employee_name": "bhat5444",
    "employee_salary": "123",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38206",
    "employee_name": "Amlslyeggst",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38207",
    "employee_name": "user4",
    "employee_salary": "254",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38208",
    "employee_name": "tJJKKJJest",
    "employee_salary": "1212321323",
    "employee_age": "45",
    "profile_image": ""
},
{
    "id": "38209",
    "employee_name": "testvishal",
    "employee_salary": "9634",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38210",
    "employee_name": "AAAAAAA",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38211",
    "employee_name": "Ram11",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38212",
    "employee_name": "bhat54",
    "employee_salary": "123",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38214",
    "employee_name": "Ram20",
    "employee_salary": "123",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38215",
    "employee_name": "bhat44",
    "employee_salary": "123",
    "employee_age": "25",
    "profile_image": ""
},
{
    "id": "38216",
    "employee_name": "test4",
    "employee_salary": "1234",
    "employee_age": "123",
    "profile_image": ""
},
{
    "id": "38218",
    "employee_name": "test5",
    "employee_salary": "1234",
    "employee_age": "123",
    "profile_image": ""
},
{
    "id": "38219",
    "employee_name": "BBBBB",
    "employee_salary": "1230",
    "employee_age": "23",
    "profile_image": ""
},
{
    "id": "38172",
    "employee_name": "test23",
    "employee_salary": "20",
    "employee_age": "10",
    "profile_image": ""
},
{
    "id": "38172",
    "employee_name": "test23",
    "employee_salary": "20",
    "employee_age": "10",
    "profile_image": ""
},
{
    "id": "38172",
    "employee_name": "test23",
    "employee_salary": "20",
    "employee_age": "10",
    "profile_image": ""
},
{
    "id": "38172",
    "employee_name": "test23",
    "employee_salary": "20",
    "employee_age": "10",
    "profile_image": ""
},
{
    "id": "38172",
    "employee_name": "test23",
    "employee_salary": "20",
    "employee_age": "10",
    "profile_image": ""
}
]
`;



var data = editId(JSON.parse(jsonData));
/**
 * edits the id of every element
 * @param {Array} json - original data
 */
function editId(json) {
    var data = [];
    var index = 1;
    for(let obj of json) {
        obj.id = index;
        data.push(obj);
        index++;
    }
    return data;
}

var headings = Object.keys(data[0]);
/**
 * this function invokes the main two function when window loads
 */
window.onload = function() {
    extractingheader(headings);
    loadTable(1);
};

var table = document.querySelector("table");
/**
 * this function fills heading section of the table
 * @param {array} heading - list of headings
 */
function extractingheader(headingArr) {
    var thead = table.createTHead();
    var tr = thead.insertRow();
    for(let heading of headingArr) {
        let th = document.createElement("th");
        let th_capitaliaze = heading.charAt(0).toUpperCase() + heading.slice(1).replace(/_/g," ");
        th.innerText = th_capitaliaze;
        tr.appendChild(th);
    }
}

var currentPage = 1;
var recordsPerPage = 10;
/**
 * this function shows previous page
 */
function prevPage(){
    if (currentPage > 1) {
        currentPage--;
        loadTable(currentPage);
    }
}
/**
 * this function shows next page
 */
function nextPage(){
    if (currentPage < numPages()) {
        currentPage++;
        loadTable(currentPage);
    }
}

var isSearched = false;
/**
 * this function invoke createTableData by deciding table shoulb be created from original data or searched data 
 * @param {number} page - this is the current page number of table
 */
function loadTable(page){
    var pageSpan = document.getElementById("page");
    pageSpan.innerHTML = page + "/" + numPages();
    if(isSearched){
        createTableData(searchedResults,page);
        toggle(page,searchedResults);
    } else {
        createTableData(data,page);
        toggle(page,data);
    }
}

/**
 * toggle function decides which button(prev and next) to show or hide
 * @param {number} page - this is the current page number of table
 * @param {array} arr - this is the array which can original array or the array created after searching table
 */
function toggle(page,arr) {
    var btnNext = document.getElementById("btnNext");
    var btnPrev = document.getElementById("btnPrev");
    if(arr.length <= recordsPerPage) {
        btnPrev.style.visibility = "hidden";
        btnNext.style.visibility = "hidden";
    } else if(page == 1) {
        btnPrev.style.visibility = "hidden";
        btnNext.style.visibility = "visible";
    } else if(page == numPages()) {
        btnNext.style.visibility = "hidden";
        btnPrev.style.visibility = "visible";
    } else {
        btnPrev.style.visibility = "visible";
        btnNext.style.visibility = "visible";
    }
}

/**
 * creates the total number of pages according to availabe data
 */
function numPages(){
    if(isSearched) {
        return Math.ceil(searchedResults.length / recordsPerPage);
    } else {
        return Math.ceil(data.length / recordsPerPage);
    }
}

var searchedResults;
/**
 * this function checks the input value and search it in data
 */
function search() {
    searchedResults = [];
    isSearched = false;
    var input = document.getElementById("myInput");
    var filter = input.value.toUpperCase();
    var pageSpan = document.getElementById("page");
    for(let obj of data) {
        if(obj.employee_name.toUpperCase().includes(filter)) searchedResults.push(obj);
    }
    if(searchedResults) {
        isSearched = true;
        currentPage = 1;
        pageSpan.innerHTML = currentPage + "/" + numPages();
        createTableData(searchedResults,currentPage);
        toggle(currentPage,searchedResults);
    }
}

var tbody = table.createTBody();
/**
 * this function creates the table row and fill it with details
 * @param {Array} tableData - it contains data from which table is to be created
 * @param {number} currentPage - this is the current page number of table
 */
function createTableData(tableData,currentPage) {
    tbody.innerHTML = "";
    for(let i = (currentPage-1)*recordsPerPage; i<currentPage*recordsPerPage;i++){
        let tr = tbody.insertRow();
        if(tableData[i]) {
            for(let heading of headings) {
                let tablecell = tr.insertCell();
                tablecell.innerText = tableData[i][heading];
            }
        }
    }
}